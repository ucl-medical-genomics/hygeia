Readme

Data-Preprocessing

The following script generates for each chromosome a text files containing (i) CpG positions, (ii) methylated reads control group, (iii) methylated reads case group, (iv) total reads control group, and (v) total reads case group.
These are the input count files for Hygeia. In this script, we use all CpG sites from the reference genome. 
We use the methylation data generated from gemBS. 
However, Hygeia should work as long as the generated files are indexed at the same CpG positions (possibly with zero methylated or total reads).

python DataProcessing/preprocess_data.py

Command flags:
-cpg_file_path: path to file that contains all CpG sites that one wants to use (will be imputed if missing in methylation count files). File should be tab separated.
-output_path: directory where the count files are saved
-case_data_path: list of paths of the methylation data for the case group as generated by gemBS.
-case_id_names: names of the case ids that are used in the gemBS output files
-control_data_path: list of paths of the methylation data for the control group as generated by gemBS.
-control_id_names: names of the control ids that are used in the gemBS output files



Case-Control Model Inference

The following script generates for a given chromosome the full Hygeia outputs. 
This includes the particles (duration and METEOR/regime) for the backward simulation.
The results can be seen as one Monte Carlo sample (specified by the seed flag) of the algorithm.
These outputs can be used to test/discover for DMPs/DMRs with further scripts.

python CaseControlScripts/run_inference_two_groups.py

Command flags (necessary files and chromosome):
-results_dir: path dir where to save the results
-data_dir: path where the count data is saved (e.g. as outputs from preprocess_data.py)
-single_group_dir: path where the model parameters of the single group model are saved 
-chrom: chromosome number for the analysis

There are also a couple of model specific or inference specific flags that can be adjusted.